class App extends React.Component {

  constructor(props) {
    super(props);
    this.state = {

      board: [[0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0]],
      isFirstPlayer: true,
      winner: null

    };
    this.onClick = this.onClick.bind(this);
  }

  onClick(col) {
    console.log('clicked!', col);

    var copyBoard = this.state.board.slice(0);
    var row = 0;
    for (var i = 0; i < copyBoard.length; i++) {
      if (copyBoard[i][col] === 0) {
        row = i;
      }
    }

    copyBoard[row][col] = this.state.isFirstPlayer ? 1 : -1;
    console.log(copyBoard);

    this.setState({
      board: copyBoard,
      isFirstPlayer: !this.state.isFirstPlayer
    });

    this.checkRows();
    this.checkCols();
    this.checkRightDiags();
    this.checkLeftDiags();
  }

  checkRows() {

    var board = this.state.board;
    for (var i = 0; i < board.length; i++) {

      for (var c = 0; c < board[0].length - 3; c++) {
        var row = board[i];
        var square = row[c];
        if (square !== 0) {
          if (square === row[c + 1] && square === row[c + 2] && square === row[c + 3]) {
            if (square === 1) {
              this.setState({
                winner: 'firstPlayer'
              });
            } else {
              this.setState({
                winner: 'secondPlayer'
              });
            }
          }
        }
      }
    }
  }

  checkCols() {

    var board = this.state.board;
    for (var c = 0; c < board[0].length; c++) {

      for (var r = board.length - 1; r > 2; r--) {
        var square = board[r][c];

        if (square !== 0) {
          if (square === board[r - 1][c] && square === board[r - 2][c] && square === board[r - 3][c]) {
            if (square === 1) {
              this.setState({
                winner: 'firstPlayer'
              });
            } else {
              this.setState({
                winner: 'secondPlayer'
              });
            }
          }
        }
      }
    }
  }

  checkRightDiags() {

    var board = this.state.board;
    for (var r = 3; r < board.length; r++) {
      var row = board[r];
      for (var c = 0; c < board.length - 3; c++) {
        var square = row[c];
        if (square !== 0) {
          if (square === board[r - 1][c + 1] && square === board[r - 2][c + 2] && square === board[r - 3][c + 3]) {
            if (square === 1) {
              this.setState({
                winner: 'firstPlayer'
              });
            } else {
              this.setState({
                winner: 'secondPlayer'
              });
            }
          }
        }
      }
    }
  }

  checkLeftDiags() {

    var board = this.state.board;
    for (var r = 0; r < board.length - 3; r++) {
      var row = board[r];
      for (var c = 0; c < board[0].length - 3; c++) {
        var square = row[c];
        if (square !== 0) {
          if (square === board[r + 1][c + 1] && square === board[r + 2][c + 2] && square === board[r + 3][c + 3]) {
            if (square === 1) {
              this.setState({
                winner: 'firstPlayer'
              });
            } else {
              this.setState({
                winner: 'secondPlayer'
              });
            }
          }
        }
      }
    }
  }

  render() {

    return React.createElement(
      'div',
      null,
      React.createElement(
        'h1',
        null,
        'CONNECT 4 TO WIN'
      ),
      React.createElement(
        'table',
        null,
        React.createElement(
          'tbody',
          null,
          React.createElement(Headers, { data: [0, 1, 2, 3, 4, 5, 6], selectColumn: this.onClick }),
          this.state.board.map((row, index) => {
            return React.createElement(Row, { key: index, data: row, row: index, selectSquare: this.onClick });
          })
        )
      ),
      React.createElement(
        'div',
        null,
        this.state.winner ? React.createElement(
          'div',
          null,
          'Winner!'
        ) : React.createElement('div', null)
      )
    );
  }
}

var Headers = ({ data, selectColumn }) => React.createElement(
  'tr',
  null,
  data.map((row, index) => {
    return React.createElement(
      'th',
      { key: index, onClick: () => {
          selectColumn(index);
        } },
      'v'
    );
  })
);

var Row = ({ data, row, selectSquare }) => React.createElement(
  'tr',
  null,
  data.map((square, index) => {

    if (square !== 0) {
      return React.createElement('td', { key: index, className: square === 1 ? 'yellow' : 'red' });
    } else {
      return React.createElement('td', { key: index });
    }
  })
);

window.App = App;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2FwcC5qc3giXSwibmFtZXMiOlsiQXBwIiwiUmVhY3QiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInByb3BzIiwic3RhdGUiLCJib2FyZCIsImlzRmlyc3RQbGF5ZXIiLCJ3aW5uZXIiLCJvbkNsaWNrIiwiYmluZCIsImNvbCIsImNvbnNvbGUiLCJsb2ciLCJjb3B5Qm9hcmQiLCJzbGljZSIsInJvdyIsImkiLCJsZW5ndGgiLCJzZXRTdGF0ZSIsImNoZWNrUm93cyIsImNoZWNrQ29scyIsImNoZWNrUmlnaHREaWFncyIsImNoZWNrTGVmdERpYWdzIiwiYyIsInNxdWFyZSIsInIiLCJyZW5kZXIiLCJtYXAiLCJpbmRleCIsIkhlYWRlcnMiLCJkYXRhIiwic2VsZWN0Q29sdW1uIiwiUm93Iiwic2VsZWN0U3F1YXJlIiwid2luZG93Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxHQUFOLFNBQWtCQyxNQUFNQyxTQUF4QixDQUFrQzs7QUFFaENDLGNBQVlDLEtBQVosRUFBbUI7QUFDakIsVUFBTUEsS0FBTjtBQUNBLFNBQUtDLEtBQUwsR0FBYTs7QUFFVEMsYUFBTyxDQUFDLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLENBQVQsRUFBVyxDQUFYLEVBQWEsQ0FBYixDQUFELEVBQWtCLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLENBQVQsRUFBVyxDQUFYLEVBQWEsQ0FBYixDQUFsQixFQUFtQyxDQUFDLENBQUQsRUFBRyxDQUFILEVBQUssQ0FBTCxFQUFPLENBQVAsRUFBUyxDQUFULEVBQVcsQ0FBWCxFQUFhLENBQWIsQ0FBbkMsRUFBbUQsQ0FBQyxDQUFELEVBQUcsQ0FBSCxFQUFLLENBQUwsRUFBTyxDQUFQLEVBQVMsQ0FBVCxFQUFXLENBQVgsRUFBYSxDQUFiLENBQW5ELEVBQW9FLENBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUCxFQUFTLENBQVQsRUFB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S0FBVixFQUFpQixNQUFNYixHQUF2QixFQUE0QixLQUFLYSxLQUFqQyxFQUF3QyxjQUFjLEtBQUtwQixPQUEzRCxHQUFQO0FBQ0QsV0FGRDtBQUhGO0FBREYsT0FIRjtBQWVFO0FBQUE7QUFBQTtBQUNLLGFBQUtKLEtBQUwsQ0FBV0csTUFBWixHQUF1QjtBQUFBO0FBQUE7QUFBQTtBQUFBLFNBQXZCLEdBQThDO0FBRGxEO0FBZkYsS0FGRjtBQTJCRDtBQTFLK0I7O0FBNktsQyxJQUFJc0IsVUFBVSxDQUFDLEVBQUNDLElBQUQsRUFBT0MsWUFBUCxFQUFELEtBRVo7QUFBQTtBQUFBO0FBR0lELE9BQUtILEdBQUwsQ0FBUyxDQUFDWixHQUFELEVBQU1hLEtBQU4sS0FBZ0I7QUFDdkIsV0FBTztBQUFBO0FBQUEsUUFBSSxLQUFLQSxLQUFULEVBQWdCLFNBQVUsTUFBSztBQUFDRyx1QkFBYUgsS0FBYjtBQUFvQixTQUFwRDtBQUFBO0FBQUEsS0FBUDtBQUNELEdBRkQ7QUFISixDQUZGOztBQWNBLElBQUlJLE1BQU0sQ0FBQyxFQUFDRixJQUFELEVBQU9mLEdBQVAsRUFBWWtCLFlBQVosRUFBRCxLQUVSO0FBQUE7QUFBQTtBQUVJSCxPQUFLSCxHQUFMLENBQVUsQ0FBQ0gsTUFBRCxFQUFRSSxLQUFSLEtBQWtCOztBQUUxQixRQUFJSixXQUFXLENBQWYsRUFBa0I7QUFDaEIsYUFBTyw0QkFBSSxLQUFLSSxLQUFULEVBQWdCLFdBQVlKLFdBQVMsQ0FBVixHQUFlLFFBQWYsR0FBeUIsS0FBcEQsR0FBUDtBQUNELEtBRkQsTUFFTztBQUNMLGFBQU8sNEJBQUksS0FBS0ksS0FBVCxHQUFQO0FBRUQ7QUFDRixHQVJEO0FBRkosQ0FGRjs7QUFtQkFNLE9BQU9uQyxHQUFQLEdBQWFBLEdBQWIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQXBwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKVxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgXG4gICAgICAgIGJvYXJkOiBbWzAsMCwwLDAsMCwwLDBdLCBbMCwwLDAsMCwwLDAsMF0sIFswLDAsMCwwLDAsMCwwXSxbMCwwLDAsMCwwLDAsMF0sIFswLDAsMCwwLDAsMCwwXSwgWzAsMCwwLDAsMCwwLDBdXSxcbiAgICAgICAgaXNGaXJzdFBsYXllcjogdHJ1ZSxcbiAgICAgICAgd2lubmVyOiBudWxsXG4gICAgICBcbiAgICB9XG4gICAgdGhpcy5vbkNsaWNrID0gdGhpcy5vbkNsaWNrLmJpbmQodGhpcyk7XG5cbiAgfVxuXG4gIFxuICBvbkNsaWNrKGNvbCkge1xuICAgIGNvbnNvbGUubG9nKCdjbGlja2VkIScsIGNvbCk7XG4gICAgXG4gICAgdmFyIGNvcHlCb2FyZCA9ICB0aGlzLnN0YXRlLmJvYXJkLnNsaWNlKDApO1xuICAgIHZhciByb3cgPSAwO1xuICAgIGZvciAodmFyIGk9MDsgaTxjb3B5Qm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChjb3B5Qm9hcmRbaV1bY29sXSA9PT0gMCkge1xuICAgICAgICByb3cgPSBpO1xuICAgICAgfVxuICAgIH0gICAgXG4gIFxuICAgIGNvcHlCb2FyZFtyb3ddW2NvbF0gPSB0aGlzLnN0YXRlLmlzRmlyc3RQbGF5ZXIgPyAxIDogLTE7XG4gICAgY29uc29sZS5sb2coY29weUJvYXJkKTtcblxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgYm9hcmQ6ICAgY29weUJvYXJkLFxuICAgICAgaXNGaXJzdFBsYXllcjogIXRoaXMuc3RhdGUuaXNGaXJzdFBsYXllclxuICAgIH0pO1xuICBcbiAgICB0aGlzLmNoZWNrUm93cygpO1xuICAgIHRoaXMuY2hlY2tDb2xzKCk7XG4gICAgdGhpcy5jaGVja1JpZ2h0RGlhZ3MoKTtcbiAgICB0aGlzLmNoZWNrTGVmdERpYWdzKCk7XG5cbiAgfVxuXG4gIGNoZWNrUm93cygpIHtcbiAgICBcbiAgICB2YXIgYm9hcmQgPSB0aGlzLnN0YXRlLmJvYXJkO1xuICAgIGZvciAodmFyIGk9MDsgaTxib2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgXG4gICAgICBmb3IgKHZhciBjPTA7IGM8Ym9hcmRbMF0ubGVuZ3RoLTM7IGMrKykge1xuICAgICAgICB2YXIgcm93ID0gYm9hcmRbaV07XG4gICAgICAgIHZhciBzcXVhcmUgPSByb3dbY107XG4gICAgICAgIGlmIChzcXVhcmUgIT09IDApIHtcbiAgICAgICAgICBpZiAoc3F1YXJlID09PSByb3dbYysxXSAmJiBzcXVhcmUgPT09IHJvd1tjKzJdICYmIHNxdWFyZSA9PT0gcm93W2MrM10pIHtcbiAgICAgICAgICAgIGlmIChzcXVhcmUgPT09IDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgd2lubmVyOiAnZmlyc3RQbGF5ZXInXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHdpbm5lcjogJ3NlY29uZFBsYXllcidcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSAgICAgIFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNoZWNrQ29scygpe1xuICBcbiAgICB2YXIgYm9hcmQgPSB0aGlzLnN0YXRlLmJvYXJkO1xuICAgIGZvciAodmFyIGM9MDsgYzxib2FyZFswXS5sZW5ndGg7IGMrKykge1xuXG4gICAgICBmb3IgKHZhciByPWJvYXJkLmxlbmd0aC0xOyByPjI7IHItLSkge1xuICAgICAgICB2YXIgc3F1YXJlID0gYm9hcmRbcl1bY107XG4gICAgICAgIFxuICAgICAgICBpZiAoc3F1YXJlICE9PSAwKSB7XG4gICAgICAgICAgaWYgKHNxdWFyZSA9PT0gYm9hcmRbci0xXVtjXSAmJiBzcXVhcmUgPT09IGJvYXJkW3ItMl1bY10gJiYgc3F1YXJlID09PSBib2FyZFtyLTNdW2NdKSB7XG4gICAgICAgICAgICBpZiAoc3F1YXJlID09PSAxKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHdpbm5lcjogJ2ZpcnN0UGxheWVyJ1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICB3aW5uZXI6ICdzZWNvbmRQbGF5ZXInXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjaGVja1JpZ2h0RGlhZ3MoKXtcbiAgICBcbiAgICAgIHZhciBib2FyZCA9IHRoaXMuc3RhdGUuYm9hcmQ7XG4gICAgICBmb3IgKHZhciByPTM7IHI8Ym9hcmQubGVuZ3RoOyByKyspIHtcbiAgICAgICAgdmFyIHJvdyA9IGJvYXJkW3JdO1xuICAgICAgICBmb3IgKHZhciBjPTA7IGM8Ym9hcmQubGVuZ3RoLTM7IGMrKykge1xuICAgICAgICAgIHZhciBzcXVhcmUgPSByb3dbY107XG4gICAgICAgICAgaWYgKHNxdWFyZSAhPT0gMCkge1xuICAgICAgICAgICAgaWYgKHNxdWFyZSA9PT0gYm9hcmRbci0xXVtjKzFdICYmIHNxdWFyZSA9PT0gYm9hcmRbci0yXVtjKzJdICYmIHNxdWFyZSA9PT0gYm9hcmRbci0zXVtjKzNdKSB7XG4gICAgICAgICAgICAgIGlmIChzcXVhcmUgPT09IDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgd2lubmVyOiAnZmlyc3RQbGF5ZXInXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgd2lubmVyOiAnc2Vjb25kUGxheWVyJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICB9XG5cbiAgY2hlY2tMZWZ0RGlhZ3MoKSB7XG4gIFxuICAgICAgdmFyIGJvYXJkID0gdGhpcy5zdGF0ZS5ib2FyZDtcbiAgICAgIGZvciAodmFyIHI9MDsgcjxib2FyZC5sZW5ndGgtMzsgcisrKSB7XG4gICAgICAgIHZhciByb3cgPSBib2FyZFtyXTtcbiAgICAgICAgZm9yICh2YXIgYz0wOyBjPGJvYXJkWzBdLmxlbmd0aC0zOyBjKyspIHtcbiAgICAgICAgICB2YXIgc3F1YXJlID0gcm93W2NdO1xuICAgICAgICAgIGlmIChzcXVhcmUgIT09IDApIHtcbiAgICAgICAgICAgIGlmIChzcXVhcmUgPT09IGJvYXJkW3IrMV1bYysxXSAmJiBzcXVhcmUgPT09IGJvYXJkW3IrMl1bYysyXSAmJiBzcXVhcmUgPT09IGJvYXJkW3IrM11bYyszXSl7XG4gICAgICAgICAgICAgIGlmIChzcXVhcmUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgIHdpbm5lcjogJ2ZpcnN0UGxheWVyJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHdpbm5lcjogJ3NlY29uZFBsYXllcidcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSAgIFxuICAgICAgICB9XG4gICAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG5cbiAgICByZXR1cm4gIChcblxuICAgICAgPGRpdj5cbiAgICAgICAgPGgxPkNPTk5FQ1QgNCBUTyBXSU48L2gxPlxuICAgICAgXG4gICAgICAgIDx0YWJsZT5cbiAgICAgICAgICA8dGJvZHk+XG4gICAgICAgICAgPEhlYWRlcnMgZGF0YT17WzAsMSwyLDMsNCw1LDZdfSBzZWxlY3RDb2x1bW49e3RoaXMub25DbGlja30gLz4gICBcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmJvYXJkLm1hcCgocm93LCBpbmRleCk9PiB7XG4gICAgICAgICAgICAgIHJldHVybiA8Um93IGtleT17aW5kZXh9IGRhdGE9e3Jvd30gcm93PXtpbmRleH0gc2VsZWN0U3F1YXJlPXt0aGlzLm9uQ2xpY2t9IC8+XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICA8L3RhYmxlPiAgXG5cbiAgICAgICAgXG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgeyAodGhpcy5zdGF0ZS53aW5uZXIpID8gKDxkaXY+V2lubmVyITwvZGl2PikgOiAgPGRpdj48L2Rpdj59XG4gICAgICAgIDwvZGl2PlxuXG5cbiAgICAgIDwvZGl2PlxuXG4gICAgICBcblxuICAgIClcbiAgfVxufVxuXG52YXIgSGVhZGVycyA9ICh7ZGF0YSwgc2VsZWN0Q29sdW1ufSkgPT4gIChcblxuICA8dHI+XG4gICAge1xuICAgIFxuICAgICAgZGF0YS5tYXAoKHJvdywgaW5kZXgpID0+IHtcbiAgICAgICAgcmV0dXJuIDx0aCBrZXk9e2luZGV4fSBvbkNsaWNrPXsgKCk9PiB7c2VsZWN0Q29sdW1uKGluZGV4KX19PnY8L3RoPlxuICAgICAgfSlcbiAgICAgIFxuICAgIH1cbiAgPC90cj5cblxuKVxuXG52YXIgUm93ID0gKHtkYXRhLCByb3csIHNlbGVjdFNxdWFyZX0pID0+IChcblxuICA8dHI+XG4gICAge1xuICAgICAgZGF0YS5tYXAoIChzcXVhcmUsaW5kZXgpID0+IHtcblxuICAgICAgICBpZiAoc3F1YXJlICE9PSAwKSB7XG4gICAgICAgICAgcmV0dXJuIDx0ZCBrZXk9e2luZGV4fSBjbGFzc05hbWU9eyhzcXVhcmU9PT0xKSA/ICd5ZWxsb3cnOiAncmVkJ30+PC90ZD5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gPHRkIGtleT17aW5kZXh9PjwvdGQ+XG5cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIDwvdHI+XG5cbilcblxuXG53aW5kb3cuQXBwID0gQXBwO1xuIl19